<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Our Safe Space | For Babde</title>
    <style>
        :root {
            --midnight: #0f0c29;
            --lavender: #b794f4;
            --rose-gold: #e9baaa;
            --gold: #ffd700;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Arial, sans-serif; -webkit-tap-highlight-color: transparent; }

        body {
            background: var(--midnight);
            color: white;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* --- 4-7-8 Pulse Background (Grounding) --- */
        #bg-pulse {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -2;
            background: radial-gradient(circle, #24243e 0%, #0f0c29 100%);
            animation: pulse-bg 19s infinite ease-in-out;
        }

        @keyframes pulse-bg {
            0%, 100% { filter: brightness(1); }
            21% { filter: brightness(1.7); }    /* Inhale 4s */
            58% { filter: brightness(1.7); }    /* Hold 7s */
            100% { filter: brightness(1); }     /* Exhale 8s */
        }

        #canvas-stars { position: fixed; top: 0; left: 0; z-index: -1; pointer-events: none; }

        /* --- UI Logic --- */
        .screen {
            position: absolute;
            width: 85%; max-width: 400px;
            text-align: center; display: none;
            flex-direction: column; align-items: center;
            animation: fadeIn 0.8s ease-out forwards;
        }
        .active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h1 { color: var(--rose-gold); font-weight: 300; margin-bottom: 10px; }
        p { color: #ccc; line-height: 1.5; margin-bottom: 20px; font-size: 0.95rem; }

        /* --- Tools: Jar & Bottle --- */
        .jar-btn {
            position: fixed; top: 20px; right: 20px;
            font-size: 30px; cursor: pointer; filter: drop-shadow(0 0 5px var(--gold));
            z-index: 100;
        }
        .bottle-btn {
            position: fixed; top: 20px; left: 20px;
            font-size: 30px; cursor: pointer; filter: drop-shadow(0 0 5px var(--lavender));
            z-index: 100;
        }
        .pop-msg {
            position: fixed; top: 80px; left: 50%; transform: translateX(-50%);
            background: rgba(40, 40, 70, 0.95); padding: 20px; border-radius: 15px;
            border: 1px solid var(--gold); width: 85%; backdrop-filter: blur(10px);
            display: none; z-index: 101; font-size: 0.95rem; text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        /* --- Interaction Elements --- */
        .cloud {
            position: absolute; background: rgba(255,255,255,0.08);
            padding: 10px 18px; border-radius: 25px; border: 1px solid rgba(255,255,255,0.15);
            cursor: pointer; transition: 0.3s;
        }
        .breathe-text { font-size: 0.8rem; color: var(--lavender); letter-spacing: 2px; margin-top: 15px; }
        
        button {
            background: rgba(233, 186, 170, 0.1); border: 1px solid var(--rose-gold);
            color: var(--rose-gold); padding: 12px 25px; border-radius: 25px;
            cursor: pointer; font-size: 0.9rem;
        }

        #final-heart { font-size: 100px; margin: 20px 0; cursor: pointer; filter: drop-shadow(0 0 15px var(--rose-gold)); }
        .progress-container { width: 100%; height: 4px; background: #222; border-radius: 2px; margin: 15px 0; display: none;}
        #progress-bar { height: 100%; width: 0%; background: var(--gold); box-shadow: 0 0 10px var(--gold); }
        
        .letter-box {
            background: rgba(0,0,0,0.6); padding: 25px; border-radius: 20px;
            border: 1px solid var(--rose-gold); text-align: left; font-size: 0.95rem;
            line-height: 1.7; display: none; animation: fadeIn 2s;
        }

        .distance-footer { position: fixed; bottom: 15px; font-size: 0.7rem; color: #555; letter-spacing: 1px; }

        .rain-word {
            position: fixed; color: rgba(233, 186, 170, 0.2);
            font-size: 0.9rem; pointer-events: none; z-index: -1;
            animation: fall linear forwards;
        }
        @keyframes fall { to { transform: translateY(110vh); } }
    </style>
</head>
<body>

    <div id="bg-pulse"></div>
    <canvas id="canvas-stars"></canvas>

    <div class="jar-btn" onclick="showJar()">ü´ô</div>
    <div class="bottle-btn" onclick="showBottle()">üçæ</div>
    <div id="toast-msg" class="pop-msg"></div>

    <audio id="bg-music" loop>
        <source src="https://www.chosic.com/wp-content/uploads/2021/04/Rain-and-Light-Piano.mp3" type="audio/mpeg">
    </audio>

    <div id="intro" class="screen active">
        <h1>Hey Babde</h1>
        <p>Take a deep breath with the pulse of the screen. I built this place just for you.</p>
        <div style="font-size: 50px; animation: breathe-scale 8s infinite;">‚ú®</div>
        <div class="breathe-text" id="breathe-instruction">Inhale (4s)</div>
        <button onclick="startApp()" style="margin-top:30px">Enter Our Safe Space</button>
    </div>

    <div id="phase1" class="screen">
        <h1>Clear the Noise</h1>
        <p>Tap the doubts to see the only truth that exists.</p>
        <div id="cloud-container" style="height: 250px; width: 100%; position: relative;"></div>
        <div id="truth-display" style="color: var(--gold); min-height: 40px; font-style: italic;"></div>
        <button id="p1-next" style="display:none; margin-top:20px;" onclick="showScreen('phase2')">Our History</button>
    </div>

    <div id="phase2" class="screen">
        <h1>Always You</h1>
        <div style="width: 100%;">
            <div class="cloud" style="position:static; margin-bottom:15px; width:100%;" onclick="showT('2015')">
                <span style="color:var(--gold)">2015</span> - The Beginning
            </div>
            <div id="t1" style="font-size:0.9rem; margin-bottom:20px; color:#bbb;"></div>
            
            <div class="cloud" style="position:static; margin-bottom:15px; width:100%;" onclick="showT('2024')">
                <span style="color:var(--gold)">Oct 2, 2024</span> - The Promise
            </div>
            <div id="t2" style="font-size:0.9rem; margin-bottom:20px; color:#bbb;"></div>
        </div>
        <button id="p2-next" style="display:none;" onclick="showScreen('finale')">My Eternal Promise</button>
    </div>

    <div id="finale" class="screen">
        <h1 id="f-title">Hold My Heart</h1>
        <p id="f-sub">Press and hold the heart, Siddhavi.</p>
        <div id="final-heart">‚ù§Ô∏è</div>
        <div class="progress-container" id="p-cont"><div id="progress-bar"></div></div>
        
        <div id="letter" class="letter-box">
            <strong>My dearest Babde,</strong><br><br>
            I know the thoughts in your head can be loud, but my love for you is louder. I have loved you since 2015. You are the girl I waited for, and Oct 2, 2024, was the best day of my life. <br><br>
            I am intensely loyal to you, Siddhavi. I would never mid-way leave you for anyone else. You are my home. Stay here with me.<br><br>
            <a href="tel:YOUR_PHONE_NUMBER" style="color: var(--gold); text-decoration: none; border: 1px solid var(--gold); padding: 8px 15px; border-radius: 10px; display: inline-block; font-size: 0.8rem;">Tap to Call Me Now</a>
        </div>
    </div>

    <div class="distance-footer">DISTANCE FROM MY HEART TO YOURS: 0.00 KM</div>

    <script>
        // --- Music & Start ---
        function startApp() {
            document.getElementById('bg-music').play();
            showScreen('phase1');
        }

        // --- Grounding Breath Text ---
        let bStep = 0;
        const bText = ["Inhale (4s)", "Hold (7s)", "Exhale (8s)"];
        setInterval(() => {
            const el = document.getElementById('breathe-instruction');
            if(el) {
                el.innerText = bText[bStep];
                bStep = (bStep + 1) % 3;
            }
        }, 6300);

        // --- Star Field ---
        const canvas = document.getElementById('canvas-stars');
        const ctx = canvas.getContext('2d');
        let stars = [];
        function initStars() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            for(let i=0; i<80; i++) stars.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height, r: Math.random()*1.2});
        }
        function drawStars() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            ctx.fillStyle = "white";
            stars.forEach(s => { ctx.beginPath(); ctx.arc(s.x, s.y, s.r, 0, Math.PI*2); ctx.fill(); });
            requestAnimationFrame(drawStars);
        }
        initStars(); drawStars();

        // --- The Reason Jar (Updated) ---
        const reasons = [
            "Siddhavi, you are the only one I have ever truly loved in my whole life.",
            "You made every other girl on this planet unattractive to me.",
            "The way you care for me makes me feel more special than anyone ever has.",
            "Since 2015, my heart has only beat for one person. You.",
            "There is no 'other girl' because no one can compete with my Babde.",
            "I feel like a King when I'm with you. You are my reality."
        ];
        function showJar() {
            const toast = document.getElementById('toast-msg');
            toast.innerText = reasons[Math.floor(Math.random()*reasons.length)];
            toast.style.display = 'block';
            setTimeout(() => toast.style.display = 'none', 4000);
        }

        // --- Truth Bottle ---
        const truths = [
            "I am intensely loyal to you.",
            "You are not a choice, you are my home.",
            "October 2, 2024 was the day I became whole.",
            "I will never leave you mid-way. I'm here for the end."
        ];
        function showBottle() {
            const toast = document.getElementById('toast-msg');
            toast.innerText = truths[Math.floor(Math.random()*truths.length)];
            toast.style.display = 'block';
            setTimeout(() => toast.style.display = 'none', 3500);
        }

        // --- Navigation ---
        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if(id === 'phase1') loadClouds();
            if(id === 'finale') startRain();
        }

        // --- Clouds ---
        const thoughts = ["Fear", "Insecurity", "What if?", "Comparison", "Doubt"];
        const answers = ["I see only you.", "My loyalty is yours.", "I'm never leaving.", "You're incomparable.", "You are my world."];
        let popCount = 0;
        function loadClouds() {
            const container = document.getElementById('cloud-container');
            container.innerHTML = '';
            thoughts.forEach((t, i) => {
                const c = document.createElement('div');
                c.className = 'cloud'; c.innerText = t;
                c.style.top = Math.random()*70 + '%'; c.style.left = Math.random()*60 + '%';
                c.onclick = () => {
                    c.style.transform = 'scale(0)';
                    document.getElementById('truth-display').innerText = answers[i];
                    popCount++;
                    if(popCount >= 3) document.getElementById('p1-next').style.display = 'block';
                }
                container.appendChild(c);
            });
        }

        // --- Timeline ---
        let tCount = 0;
        function showT(y) {
            if(y === '2015') { document.getElementById('t1').innerText = "Nearly a decade of you being the only one in my heart."; tCount++; }
            else { document.getElementById('t2').innerText = "The day I promised to be yours forever. That promise is unbreakable."; tCount++; }
            if(tCount >= 2) document.getElementById('p2-next').style.display = 'block';
        }

        // --- Heart Hold ---
        const heart = document.getElementById('final-heart');
        const fill = document.getElementById('progress-bar');
        let hTimer; let hProg = 0;

        function hStart() {
            document.getElementById('p-cont').style.display = 'block';
            hTimer = setInterval(() => {
                hProg += 1.5;
                fill.style.width = hProg + '%';
                heart.style.transform = `scale(${1 + (hProg/100)})`;
                if(hProg >= 100) { clearInterval(hTimer); win(); }
            }, 40);
        }
        function hEnd() { if(hProg < 100) { clearInterval(hTimer); hProg = 0; fill.style.width = '0'; heart.style.transform = 'scale(1)'; } }

        heart.addEventListener('mousedown', hStart);
        heart.addEventListener('touchstart', (e) => { e.preventDefault(); hStart(); });
        window.addEventListener('mouseup', hEnd);
        window.addEventListener('touchend', hEnd);

        function win() {
            heart.style.display = 'none'; document.getElementById('p-cont').style.display = 'none';
            document.getElementById('f-sub').style.display = 'none';
            document.getElementById('letter').style.display = 'block';
            document.getElementById('f-title').innerText = "Forever Yours.";
            document.body.style.background = "radial-gradient(circle, #302418 0%, #0f0c29 100%)";
        }

        // --- Affirmation Rain ---
        function startRain() {
            setInterval(() => {
                const words = ["Siddhavi", "Loyal", "Only You", "Yours", "Babde"];
                const w = document.createElement('div');
                w.className = 'rain-word';
                w.innerText = words[Math.floor(Math.random()*words.length)];
                w.style.left = Math.random()*100 + 'vw';
                w.style.top = '-20px';
                w.style.animationDuration = (Math.random()*3 + 5) + 's';
                document.body.appendChild(w);
                setTimeout(() => w.remove(), 8000);
            }, 1800);
        }
    </script>
</body>
</html>
